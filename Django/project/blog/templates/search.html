{% load static %}
<!DOCTYPE html>
<html lang="vi">
<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Tìm bài viết</title>

   <!-- Font Awesome CDN link -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
   <link rel="icon" type="image/x-icon" href="{% static 'image/doraemon.webp' %}">
   <link rel="stylesheet" href="{% static 'css/style.css' %}">

</head>
<body>
   
{% include 'user_header.html' %}

<section class="posts-container">

   <h1 class="heading" style="text-transform: none;">Kết quả tìm kiếm của '{{ search_box }}'</h1>


   <div class="box-container">
      {% if posts %}
      {% for item in posts %}
      {% if item.post %}
          <form class="box" method="post">
              {% csrf_token %}
              <input type="hidden" name="post_id" value="{{ item.post.id }}">
              <input type="hidden" name="admin_id" value="{{ item.post.admin_id }}">
  
              <div class="post-admin">
                  <i class="fas fa-user"></i>
                  <div>
                      {% if item.post.admin and item.post.admin.name %}
                          <a href="{% url 'author_posts' author=item.post.admin.name %}">
                              {{ item.post.admin.name }}
                          </a>
                      {% else %}
                          <span>Tác giả không xác định</span>
                      {% endif %}
                      <div>{{ item.post.date }}</div>
                  </div>
              </div>
  
              {% if item.post.image %}
                  <img src="{{ item.post.image.url }}" class="post-image" alt="">
              {% endif %}
              
              <div class="post-title">{{ item.post.title }}</div>
              <div class="post-content content-150">{{ item.post.content|safe }}</div>
              <a href="{% url 'view_post' post_id=item.post.id %}" class="inline-btn">Đọc thêm</a>
              {% if item.post.category %}
                  <a href="{% url 'category' category_name=item.post.category %}" class="post-cat"> 
                      <i class="fas fa-tag"></i> 
                      <span>{{ item.post.category }}</span>
                  </a>
              {% endif %}
  
              <div class="icons">
                  <a href="{% url 'view_post' post_id=item.post.id %}">
                      <i class="fas fa-comment"></i>
                      <span>({{ item.total_comments }})</span>
                  </a>
                  <button type="submit" name="like_post">
                      <i class="fas fa-heart" style="{% if item.is_liked_by_user %}color: red;{% endif %}"></i>
                      <span>({{ item.total_likes }})</span>
                  </button>
              </div>
          </form>
      {% else %}
          <p>Bài viết không hợp lệ</p>
      {% endif %}
  {% endfor %}
  

      {% else %}
          <p class="empty">Không tìm thấy</p>
      {% endif %}
      
   </div>

</section>

{% include 'footer.html' %}

<script src="{% static 'js/script.js' %}"></script>

</body>
</html>